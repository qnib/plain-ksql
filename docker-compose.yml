version: '3'
services:
  zookeeper:
    image: qnib/plain-zookeeper@sha256:6dfdaae24f3d1ef77e76dff85a5ab8ac7edb2d145935f213b7ae5176377eacc1
    ports:
      - "2181:2181"
  zkui:
    image: qnib/plain-zkui@sha256:9659927f707a97d6c6349bcda005520c9041d49f162a2124268368d88e289a19
    ports:
      - "9090:9090"
  broker:
    image: qnib/plain-kafka:1.0.0-1@sha256:32cbccc9e88fbf1a4666f25d6b375a87b0b61000a144e75daa05c8585fd7f8db
    hostname: "{{.Service.Name}}.{{.Task.Slot}}.{{.Task.ID}}"
    ports:
      - "9092:9092"
    environment:
      KAFKA_BROKER_ID: '{{.Task.Slot}}'
  manager:
    image: qnib/plain-kafka-manager:1.3.3.14@sha256:1582cfe5ecb60a52f3ebc137cabde628923f50b8bae22e8edd7121fc72ea740a
    ports:
      - "9000:9000"
    environment:
      ZOOKEEPER_HOSTS: "tasks.zookeeper:2181"
  engine:
    image: qnib/plain-ksql:0.1-pre10
    environment:
      KAFKA_BROKERS: "tasks.broker:9092"
